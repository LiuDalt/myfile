<!DOCTYPE html>
<!-- saved from url=(0051)http://www.cnblogs.com/JczmDeveloper/p/4192117.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/ca-pub-4210569241504288.js"></script><script type="text/javascript" src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/encoder.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园</title>
<link type="text/css" rel="stylesheet" href="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/bundle-darkgreentrip.css">
<link id="mobile-style" media="only screen and (max-device-width: 980px)" type="text/css" rel="stylesheet" href="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/bundle-darkgreentrip-mobile.css">
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/JczmDeveloper/rss">
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/JczmDeveloper/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/JczmDeveloper/wlwmanifest.xml">
<script src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'JczmDeveloper', cb_enable_mathjax=false;var isLogined=false;</script>
<script src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/blog-common.js" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="http://www.cnblogs.com/JczmDeveloper/"><img id="blogLogo" src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/logo.gif" alt="返回主页"></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/JczmDeveloper/">自我挖掘 ● 超越自我-Jamy Cai</a></h1>
<h2></h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="http://www.cnblogs.com/">博客园</a></li>
<li><a id="blog_nav_myhome" class="menu" href="http://www.cnblogs.com/JczmDeveloper/">首页</a></li>
<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li><a id="blog_nav_contact" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/Jamy%20Cai">联系</a></li>
<li><a id="blog_nav_rss" class="menu" href="http://www.cnblogs.com/JczmDeveloper/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="http://www.cnblogs.com/JczmDeveloper/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<span id="stats_post_count">随笔 - 148&nbsp; </span>
<span id="stats_article_count">文章 - 0&nbsp; </span>
<span id="stats-comment_count">评论 - 76</span>
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
<div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html">Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法）</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><p>一：简介：</p>
<p>在上一篇<strong><span style="color: #ff0000;"><a href="http://www.cnblogs.com/JczmDeveloper/p/4187153.html" target="_blank"><span style="color: #ff0000;">《Android实现圆形、圆角和椭圆自定义图片View（使用BitmapShader图形渲染方法）》</span></a></span></strong>博文中，采用BitmapShader方法实现自定义的圆形、圆角等自定义ImageView，这篇我们将采用更为常见的Xfermode渲染模式方案来实现圆形、圆角和椭圆样式的ImageView，同样本实例也是直接继承ImageView，</p>
<p>这样可以省很多事情，比如测量步骤，以及不需要自己去写设置图片的方法，本文使用Xfermode模式中的DST_IN模式来实现要达到的效果，当然大家也可以采用其他的模式，比如SRC_IN等都可以实现该效果。</p>
<p><strong><span style="color: #ff0000;">（照例完整源代码在文章的最后给出下载地址哈）</span></strong></p>
<p>二：效果图：</p>
<p><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/291725264342299.png" alt=""></p>
<p>三、Xfermode渲染模式简介：</p>
<p>xfermode影响在Canvas已经有的图像上绘制新的颜色的方式&nbsp;<br>* 正常的情况下,在图像上绘制新的形状,如果新的Paint不是透明的,那么会遮挡下面的颜色.&nbsp;<br>* 如果新的Paint是透明的,那么会被染成下面的颜色&nbsp;<br><br>下面的Xfermode子类可以改变这种行为：&nbsp;<br><br>AvoidXfermode&nbsp; 指定了一个颜色和容差，强制Paint避免在它上面绘图(或者只在它上面绘图)。&nbsp;<br><br>PixelXorXfermode&nbsp; 当覆盖已有的颜色时，应用一个简单的像素XOR操作。&nbsp;<br><br>PorterDuffXfermode&nbsp; 这是一个非常强大的转换模式，使用它，可以使用图像合成的16条Porter-Duff规则的任意一条来控制Paint如何与已有的Canvas图像进行交互。</p>
<p>这里不得不提到那个经典的图：</p>
<p><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/291717407475203.jpg" alt=""></p>
<p>上面的16种模式的说明如下：</p>
<p>从上面我们可以看到<strong>PorterDuff.Mode</strong>为枚举类,一共有16个枚举值:</p>
<p><strong>1.PorterDuff.Mode.CLEAR&nbsp;&nbsp;</strong></p>
<p>&nbsp; 所绘制不会提交到画布上。<br><strong>2.PorterDuff.Mode.SRC</strong></p>
<p>&nbsp;&nbsp; 显示上层绘制图片<br><strong>3.PorterDuff.Mode.DST</strong></p>
<p>&nbsp;&nbsp;显示下层绘制图片<br><strong>4.PorterDuff.Mode.SRC_OVER</strong></p>
<p>&nbsp;&nbsp;正常绘制显示，上下层绘制叠盖。<br><strong>5.PorterDuff.Mode.DST_OVER</strong></p>
<p>&nbsp;&nbsp;上下层都显示。下层居上显示。<br><strong>6.PorterDuff.Mode.SRC_IN</strong></p>
<p>&nbsp;&nbsp; 取两层绘制交集。显示上层。<br><strong>7.PorterDuff.Mode.DST_IN</strong></p>
<p>&nbsp;&nbsp;取两层绘制交集。显示下层。<br><strong>8.PorterDuff.Mode.SRC_OUT</strong></p>
<p>&nbsp;取上层绘制非交集部分。<br><strong>9.PorterDuff.Mode.DST_OUT</strong></p>
<p>&nbsp;取下层绘制非交集部分。<br><strong>10.PorterDuff.Mode.SRC_ATOP</strong></p>
<p>&nbsp;取下层非交集部分与上层交集部分<br><strong>11.PorterDuff.Mode.DST_ATOP</strong></p>
<p>&nbsp;取上层非交集部分与下层交集部分<br><strong>12.PorterDuff.Mode.XOR</strong></p>
<p>&nbsp; 异或：去除两图层交集部分<br><strong>13.PorterDuff.Mode.DARKEN</strong></p>
<p>&nbsp; 取两图层全部区域，交集部分颜色加深<br><strong>14.PorterDuff.Mode.LIGHTEN</strong></p>
<p>&nbsp;&nbsp;取两图层全部，点亮交集部分颜色<br><strong>15.PorterDuff.Mode.MULTIPLY</strong></p>
<p>&nbsp; 取两图层交集部分叠加后颜色<br><strong>16.PorterDuff.Mode.SCREEN</strong></p>
<p>&nbsp; 取两图层全部区域，交集部分变为透明色</p>
<p>四、自定义圆形、圆角和椭圆的ImageView的实现</p>
<p>1、测量View的大小,对圆形作特殊处理</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 测量view的大小
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> onMeasure(<span style="color: #0000ff;">int</span> widthMeasureSpec, <span style="color: #0000ff;">int</span><span style="color: #000000;"> heightMeasureSpec) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span>
        <span style="color: #0000ff;">super</span><span style="color: #000000;">.onMeasure(widthMeasureSpec, heightMeasureSpec);
        </span><span style="color: #008000;">//</span><span style="color: #008000;">如果类型是圆形，则强制设置view的宽高一致，取宽高的较小值 </span>
        <span style="color: #0000ff;">if</span>(mType ==<span style="color: #000000;"> TYPE_CIRCLE){
            </span><span style="color: #0000ff;">int</span> width =<span style="color: #000000;"> Math.min(getMeasuredWidth(),getMeasuredHeight());
            setMeasuredDimension(width, width);
        }
    }</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>2、绘制不同图形的Bitmap，供onDraw()绘制的时候用</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 绘制不同的图形Bitmap
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span><span style="color: #000000;"> Bitmap getDrawBitmap(){
        Bitmap bitmap </span>=<span style="color: #000000;"> Bitmap.createBitmap(getWidth(), getHeight(),  
                Bitmap.Config.ARGB_8888);  
        Canvas canvas </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Canvas(bitmap);  
        Paint paint </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Paint(Paint.ANTI_ALIAS_FLAG);  
        paint.setColor(Color.BLACK);  
  
        </span><span style="color: #0000ff;">if</span>(mType ==<span style="color: #000000;"> TYPE_CIRCLE)
        {</span><span style="color: #008000;">//</span><span style="color: #008000;">绘制圆形 </span>
            canvas.drawCircle(getWidth() / 2, getWidth() / 2, getWidth() / 2<span style="color: #000000;">,  
                    paint); 
        }</span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(mType ==<span style="color: #000000;"> TYPE_ROUND)  
        {</span><span style="color: #008000;">//</span><span style="color: #008000;">绘制圆角矩形</span>
            canvas.drawRoundRect(<span style="color: #0000ff;">new</span> RectF(0, 0<span style="color: #000000;">, getWidth(), getHeight()),  
                    mRoundBorderRadius, mRoundBorderRadius, paint);  
        }</span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(mType ==<span style="color: #000000;"> TYPE_OVAL ){
         </span><span style="color: #008000;">//</span><span style="color: #008000;">绘制椭圆</span>
            canvas.drawOval(<span style="color: #0000ff;">new</span> RectF(0, 0<span style="color: #000000;">, getWidth(), getHeight()), mPaint);
        }
  
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> bitmap;  
    }</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>3、在onDraw（）中绘制出来</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 绘制view的内容
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDraw(Canvas canvas) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub
        </span><span style="color: #008000;">//</span><span style="color: #008000;">从缓存中取出bitmap</span>
        Bitmap bmp = (mBufferBitmap == <span style="color: #0000ff;">null</span> ? <span style="color: #0000ff;">null</span><span style="color: #000000;">:mBufferBitmap.get());
        </span><span style="color: #0000ff;">if</span>(bmp == <span style="color: #0000ff;">null</span> ||<span style="color: #000000;"> bmp.isRecycled()){
            </span><span style="color: #008000;">//</span><span style="color: #008000;">如果没有缓存存在的情况
            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取drawable</span>
            Drawable drawable =<span style="color: #000000;"> getDrawable();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取drawable的宽高</span>
            <span style="color: #0000ff;">int</span> dwidth =<span style="color: #000000;"> drawable.getIntrinsicWidth();
            </span><span style="color: #0000ff;">int</span> dheight =<span style="color: #000000;"> drawable.getIntrinsicHeight();
            Log.v(</span>"czm","dwidth="+dwidth+",width="+<span style="color: #000000;">getWidth());
            </span><span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> drawable){
                bmp </span>=<span style="color: #000000;"> Bitmap.createBitmap(getWidth(), getHeight(),  
                        Config.ARGB_8888); 
                </span><span style="color: #0000ff;">float</span> scale = 1.0f<span style="color: #000000;">;
                </span><span style="color: #008000;">//</span><span style="color: #008000;">创建画布</span>
                Canvas drawCanvas = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Canvas(bmp);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">按照bitmap的宽高，以及view的宽高，计算缩放比例；因为设置的src宽高
                </span><span style="color: #008000;">//</span><span style="color: #008000;">比例可能和imageview的宽高比例不同，这里我们不希望图片失真；  </span>
                
                <span style="color: #0000ff;">if</span>(mType ==<span style="color: #000000;"> TYPE_CIRCLE)  
                {</span><span style="color: #008000;">//</span><span style="color: #008000;">如果是圆形  </span>
                    scale = getWidth() * 1.0F /<span style="color: #000000;"> Math.min(dwidth, dheight);  
                }</span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (mType == TYPE_ROUND || mType ==<span style="color: #000000;"> TYPE_OVAL)  
                {</span><span style="color: #008000;">//</span><span style="color: #008000;">如果是圆角矩形或椭圆 
                    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 如果图片的宽或者高与view的宽高不匹配，计算出需要缩放的比例；
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">缩放后的图片的宽高，一定要大于我们view的宽高；所以我们这里取大值；  </span>
                    scale = Math.max(getWidth() * 1.0f /<span style="color: #000000;"> dwidth, getHeight()  
                            </span>* 1.0f /<span style="color: #000000;"> dheight);  
                }
                Log.v(</span>"czm","scale="+<span style="color: #000000;">scale);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">根据缩放比例，设置bounds，即相当于做缩放图片  </span>
                drawable.setBounds(0, 0, (<span style="color: #0000ff;">int</span>)(scale * dwidth), (<span style="color: #0000ff;">int</span>)(scale *<span style="color: #000000;"> dheight));
                drawable.draw(drawCanvas);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">获取bitmap，即圆形、圆角或椭圆的bitmap</span>
                <span style="color: #0000ff;">if</span>(mMaskBitmap == <span style="color: #0000ff;">null</span> ||<span style="color: #000000;"> mMaskBitmap.isRecycled()){
                    mMaskBitmap </span>=<span style="color: #000000;"> getDrawBitmap();
                }
                </span><span style="color: #008000;">//</span><span style="color: #008000;">为paint设置Xfermode 渲染模式</span>
<span style="color: #000000;">                mPaint.reset();
                mPaint.setFilterBitmap(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">);
                mPaint.setXfermode(mXfermode);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">绘制不同形状</span>
                drawCanvas.drawBitmap(mMaskBitmap, 0, 0<span style="color: #000000;">,mPaint);
                mPaint.setXfermode(</span><span style="color: #0000ff;">null</span><span style="color: #000000;">);
                
                </span><span style="color: #008000;">//</span><span style="color: #008000;">将准备好的bitmap绘制出来  </span>
                canvas.drawBitmap(bmp, 0, 0, <span style="color: #0000ff;">null</span><span style="color: #000000;">);  
                </span><span style="color: #008000;">//</span><span style="color: #008000;">bitmap缓存起来，避免每次调用onDraw，分配内存  </span>
                mBufferBitmap = <span style="color: #0000ff;">new</span> WeakReference&lt;Bitmap&gt;<span style="color: #000000;">(bmp); <br>　　　　　　　　<span style="color: #17c214;">　<span style="color: #ff00ff;">drawable.setCallback(null);</span></span>
            }
            <span style="color: #ff00ff;">bmp.recycle();</span>
        }</span><span style="color: #0000ff;">else</span><span style="color: #000000;">{
            </span><span style="color: #008000;">//</span><span style="color: #008000;">如果缓存还存在的情况</span>
            mPaint.setXfermode(<span style="color: #0000ff;">null</span><span style="color: #000000;">);  
            canvas.drawBitmap(bmp, </span>0.0f, 0.0f<span style="color: #000000;">, mPaint);  <br>　　　　　　　<span style="color: #ff00ff;">b</span></span><span style="color: #ff00ff;">mp.recycle();</span><br><br><span>　　　　　　  </span><span style="color: #0000ff;">return</span><span>; <br>　　} <br>}<br></span></pre>
<pre><span style="color: #ff00ff;">@Override</span><br><span style="color: #ff00ff;">protected void onDetachedFromWindow() {</span><br><span style="color: #ff00ff;">    super.onDetachedFromWindow();</span><br><span style="color: #ff00ff;">    mMaskBitmap.recycle();</span><br><span style="color: #ff00ff;">    mMaskBitmap = null;</span><br><span style="color: #ff00ff;">}</span></pre>
<pre><span>&nbsp;</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>4、因为使用了弱引用的缓存技术，所以需要在重写invalidate（）方法中做些释放回收资源等处理：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 因为使用了缓存技术，所以需要在invalidate中做些回收释放资源的处理
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> invalidate() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span>
        mBufferBitmap = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">if</span>(mMaskBitmap != <span style="color: #0000ff;">null</span><span style="color: #000000;">){
            mMaskBitmap.recycle();
            mMaskBitmap </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.invalidate();
    }<br></span></pre>
<pre></pre>
<pre><span style="color: #000000;">&nbsp;</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>五、视图布局的实现：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>&lt;ScrollView xmlns:android="http://schemas.android.com/apk/res/android"<span style="color: #000000;">
    xmlns:tools</span>="http://schemas.android.com/tools"<span style="color: #000000;">
    android:layout_width</span>="match_parent"<span style="color: #000000;">
    android:layout_height</span>="match_parent"
     &gt;

    &lt;<span style="color: #000000;">LinearLayout
        android:layout_width</span>="match_parent"<span style="color: #000000;">
        android:layout_height</span>="wrap_content"<span style="color: #000000;">
        android:gravity</span>="center_horizontal"<span style="color: #000000;">
        android:layout_marginTop</span>="10dp"<span style="color: #000000;">
        android:layout_marginBottom</span>="55dp"<span style="color: #000000;">
        android:orientation</span>="vertical" &gt;

        &lt;<span style="color: #000000;">com.czm.myroundimageview.XCRoundImageViewByXfermode
            android:id</span>="@+id/cicleImageView"<span style="color: #000000;">
            android:layout_width</span>="150dp"<span style="color: #000000;">
            android:layout_height</span>="150dp"<span style="color: #000000;">
            android:src</span>="@drawable/img1" /&gt;

        &lt;<span style="color: #000000;">com.czm.myroundimageview.XCRoundImageViewByXfermode
            android:id</span>="@+id/roundRectImageView"<span style="color: #000000;">
            android:layout_width</span>="125dp"<span style="color: #000000;">
            android:layout_height</span>="145dp"<span style="color: #000000;">
            android:layout_marginTop</span>="15dp"<span style="color: #000000;">
            android:src</span>="@drawable/img2" /&gt;

        &lt;<span style="color: #000000;">com.czm.myroundimageview.XCRoundImageViewByXfermode
            android:id</span>="@+id/ovalImageView"<span style="color: #000000;">
            android:layout_width</span>="140dp"<span style="color: #000000;">
            android:layout_height</span>="184dp"<span style="color: #000000;">
            android:layout_marginTop</span>="15dp"<span style="color: #000000;">
            android:src</span>="@drawable/img3" /&gt;
    &lt;/LinearLayout&gt;

&lt;/ScrollView&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>六、使用和测试自定义ImageView</p>
<p>上面直接绘制的自定义ImageView写完了，下面就是使用这个自定义的ImageView了，使用方法和普通的ImageView一样，当作普通控件使用即可。</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.czm.myroundimageview;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.app.Activity;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Activity {

    </span><span style="color: #0000ff;">private</span> XCRoundImageViewByXfermode circleImageView;<span style="color: #008000;">//</span><span style="color: #008000;">圆形图片</span>
    <span style="color: #0000ff;">private</span> XCRoundImageViewByXfermode roundRectImageView;<span style="color: #008000;">//</span><span style="color: #008000;">圆角矩形图片</span>
    <span style="color: #0000ff;">private</span> XCRoundImageViewByXfermode ovalImageView;<span style="color: #008000;">//</span><span style="color: #008000;">椭圆图片</span>
<span style="color: #000000;">    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {
        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        initViews();
    }
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 初始化Views
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> initViews(){
        circleImageView </span>=<span style="color: #000000;"> (XCRoundImageViewByXfermode)findViewById(R.id.cicleImageView);
        roundRectImageView </span>=<span style="color: #000000;"> (XCRoundImageViewByXfermode)findViewById(R.id.roundRectImageView);
        ovalImageView </span>=<span style="color: #000000;"> (XCRoundImageViewByXfermode)findViewById(R.id.ovalImageView);
        
        roundRectImageView.setType(XCRoundImageViewByXfermode.TYPE_ROUND);
        roundRectImageView.setRoundBorderRadius(</span>100<span style="color: #000000;">);
        
        ovalImageView.setType(XCRoundImageViewByXfermode.TYPE_OVAL);
        ovalImageView.setRoundBorderRadius(</span>50<span style="color: #000000;">);
        
    }

   

}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>七、照例，最后提供完整源码下载</p>
<p><strong><span style="color: #ff0000;"><a href="http://www.zhentiyuan.com/" target="_blank"><span style="color: #ff0000;">真题园网</span></a>：<a href="http://www.zhentiyuan.com/" target="_blank"><span style="color: #ff0000;">http://www.zhentiyuan.com</span></a></span></strong></p>
<p><strong><span style="color: #ff0000;">立即下载：<a href="http://download.csdn.net/detail/jczmdeveloper/8311659" target="_blank"><span style="color: #ff0000;">http://download.csdn.net/detail/jczmdeveloper/8311659</span></a></span></strong></p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory">分类: <a href="http://www.cnblogs.com/JczmDeveloper/category/568339.html" target="_blank">Android</a></div>
<div id="EntryTag">标签: <a href="http://www.cnblogs.com/JczmDeveloper/tag/android/">android</a>, <a href="http://www.cnblogs.com/JczmDeveloper/tag/%E5%9C%86%E5%BD%A2/">圆形</a>, <a href="http://www.cnblogs.com/JczmDeveloper/tag/%E5%9C%86%E8%A7%92/">圆角</a>, <a href="http://www.cnblogs.com/JczmDeveloper/tag/%E6%A4%AD%E5%9C%86/">椭圆</a>, <a href="http://www.cnblogs.com/JczmDeveloper/tag/xfermode/">xfermode</a>, <a href="http://www.cnblogs.com/JczmDeveloper/tag/%E8%87%AA%E5%AE%9A%E4%B9%89ImageView/">自定义ImageView</a></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(4192117,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
            <a id="green_channel_follow" onclick="follow(&#39;b7f4a634-49c3-e011-8673-842b2b196315&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/JczmDeveloper/" target="_blank"><img src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/20151015104519.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/JczmDeveloper/">Jamy Cai</a><br>
            <a href="http://home.cnblogs.com/u/JczmDeveloper/followees">关注 - 1</a><br>
            <a href="http://home.cnblogs.com/u/JczmDeveloper/followers">粉丝 - 100</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;b7f4a634-49c3-e011-8673-842b2b196315&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(4192117,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">1</span>
    </div>
    <div class="buryit" onclick="votePost(4192117,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
</div>
<div class="clear"></div>
<div id="post_next_prev"><a href="http://www.cnblogs.com/JczmDeveloper/p/4187153.html" class="p_n_p_prefix">« </a> 上一篇：<a href="http://www.cnblogs.com/JczmDeveloper/p/4187153.html" title="发布于2014-12-26 16:57">Android 自定义View修炼-Android实现圆形、圆角和椭圆自定义图片View（使用BitmapShader图形渲染方法）</a><br><a href="http://www.cnblogs.com/JczmDeveloper/p/4196221.html" class="p_n_p_prefix">» </a> 下一篇：<a href="http://www.cnblogs.com/JczmDeveloper/p/4196221.html" title="发布于2014-12-31 17:36">Android 自定义View修炼-【2014年最后的分享啦】Android实现自定义刮刮卡效果View</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2014-12-29 17:33</span> <a href="http://www.cnblogs.com/JczmDeveloper/">Jamy Cai</a> 阅读(<span id="post_view_count">1222</span>) 评论(<span id="post_comment_count">8</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=4192117" rel="nofollow">编辑</a> <a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#" onclick="AddToWz(4192117);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=144695,cb_entryId=4192117,cb_blogApp=currentBlogApp,cb_blogUserGuid='b7f4a634-49c3-e011-8673-842b2b196315',cb_entryCreatedDate='2014/12/29 17:33:00';loadViewCount(cb_entryId);</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"><div id="comments_pager_top"></div>
<br>
<div class="feedback_area_title">评论列表</div>
<div class="feedbackNoItems"></div>	

		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3317203" class="layer">#1楼</a><a name="3317203" id="comment_anchor_3317203"></a>  <span class="comment_date">2015-11-30 11:27</span> <a id="a_comment_author_3317203" href="http://home.cnblogs.com/u/845223/" target="_blank">得吊丝者得天下</a> <a href="http://msg.cnblogs.com/send/%E5%BE%97%E5%90%8A%E4%B8%9D%E8%80%85%E5%BE%97%E5%A4%A9%E4%B8%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3317203" class="blog_comment_body">onDraw<br>这个方法中不停的Drawable drawable = getDrawable();会出现OOM的，之前还没发现偶尔有那么几次会出现。而且Android也会有警告。<br>赶紧修复一下吧。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3317203,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3317203,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318374" class="layer">#2楼</a><a name="3318374" id="comment_anchor_3318374"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-12-01 16:36</span> <a id="a_comment_author_3318374" href="http://www.cnblogs.com/JczmDeveloper/" target="_blank">Jamy Cai</a> <a href="http://msg.cnblogs.com/send/Jamy%20Cai" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3318374" class="blog_comment_body"><a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3317203" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3317203);">@</a>
得吊丝者得天下<br>谢谢，已经修复</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3318374,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3318374,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3318374_avatar" style="display:none;">http://pic.cnblogs.com/face/322919/20151015104519.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318429" class="layer">#3楼</a><a name="3318429" id="comment_anchor_3318429"></a>  <span class="comment_date">2015-12-01 17:36</span> <a id="a_comment_author_3318429" href="http://home.cnblogs.com/u/845223/" target="_blank">得吊丝者得天下</a> <a href="http://msg.cnblogs.com/send/%E5%BE%97%E5%90%8A%E4%B8%9D%E8%80%85%E5%BE%97%E5%A4%A9%E4%B8%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3318429" class="blog_comment_body">能不能把修复的公布下。把帖子重新编辑了。。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3318429,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3318429,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318432" class="layer">#4楼</a><a name="3318432" id="comment_anchor_3318432"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-12-01 17:39</span> <a id="a_comment_author_3318432" href="http://www.cnblogs.com/JczmDeveloper/" target="_blank">Jamy Cai</a> <a href="http://msg.cnblogs.com/send/Jamy%20Cai" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3318432" class="blog_comment_body"><a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318429" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3318429);">@</a>
得吊丝者得天下<br>我已经重新编辑了，上面文章中 粉红色的 部分就是我新添加的</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3318432,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3318432,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3318432_avatar" style="display:none;">http://pic.cnblogs.com/face/322919/20151015104519.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318644" class="layer">#5楼</a><a name="3318644" id="comment_anchor_3318644"></a>  <span class="comment_date">2015-12-02 00:53</span> <a id="a_comment_author_3318644" href="http://home.cnblogs.com/u/845223/" target="_blank">得吊丝者得天下</a> <a href="http://msg.cnblogs.com/send/%E5%BE%97%E5%90%8A%E4%B8%9D%E8%80%85%E5%BE%97%E5%A4%A9%E4%B8%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3318644" class="blog_comment_body">还是会OOM，问题出在bmp = Bitmap.createBitmap(getWidth(), getHeight(), Config.ARGB_8888);</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3318644,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3318644,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318869" class="layer">#6楼</a><a name="3318869" id="comment_anchor_3318869"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-12-02 11:27</span> <a id="a_comment_author_3318869" href="http://www.cnblogs.com/JczmDeveloper/" target="_blank">Jamy Cai</a> <a href="http://msg.cnblogs.com/send/Jamy%20Cai" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3318869" class="blog_comment_body"><a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318644" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3318644);">@</a>
得吊丝者得天下<br>你是不是加载很大的图片</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3318869,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3318869,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3318869_avatar" style="display:none;">http://pic.cnblogs.com/face/322919/20151015104519.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318877" class="layer">#7楼</a><a name="3318877" id="comment_anchor_3318877"></a>  <span class="comment_date">2015-12-02 11:32</span> <a id="a_comment_author_3318877" href="http://home.cnblogs.com/u/845223/" target="_blank">得吊丝者得天下</a> <a href="http://msg.cnblogs.com/send/%E5%BE%97%E5%90%8A%E4%B8%9D%E8%80%85%E5%BE%97%E5%A4%A9%E4%B8%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3318877" class="blog_comment_body">是加载了大图片，但是我使用xutils框架加载的。难不成框架有问题。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3318877,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3318877,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318964" class="layer">#8楼</a><a name="3318964" id="comment_anchor_3318964"></a>[<span class="louzhu">楼主</span>]<span id="comment-maxId" style="display:none;">3318964</span><span id="comment-maxDate" style="display:none;">2015/12/2 13:51:18</span>  <span class="comment_date">2015-12-02 13:51</span> <a id="a_comment_author_3318964" href="http://www.cnblogs.com/JczmDeveloper/" target="_blank">Jamy Cai</a> <a href="http://msg.cnblogs.com/send/Jamy%20Cai" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3318964" class="blog_comment_body"><a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#3318877" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3318877);">@</a>
得吊丝者得天下<br>嗯，是我的代码有些问题，还是谢谢你</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3318964,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3318964,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3318964_avatar" style="display:none;">http://pic.cnblogs.com/face/322919/20151015104519.png</span>
			</div>
		</div>
	<div id="comments_pager_bottom"></div></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#" onclick="return RefreshPage();">刷新页面</a><a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html#top">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a> 或 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，<a href="http://www.cnblogs.com/">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank">【推荐】50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://group.cnblogs.com/topic/75389.html" target="_blank">【活动】优达学城正式发布“无人驾驶车工程师”课程</a><br><a href="http://www.rongcloud.cn/live" target="_blank">【推荐】移动直播百强八成都在用融云即时通讯云</a><br><a href="http://www.gcpowertools.com.cn/products/componentone_studio_enterprise.htm?utm_source=cnblogs&amp;utm_medium=blogpage&amp;utm_term=bottom&amp;utm_content=C1&amp;utm_campaign=community" target="_blank">【推荐】别再闷头写代码！找对工具，事半功倍，全能开发工具包用起来</a><br><a href="http://netease.im/promotion/1013?hmsr=bky10&amp;from=bky10" target="_blank">【福利】网易云信1周年接入开发者突破10万，送红包活动火热开展中</a><br></div>
<div id="opt_under_post"></div>
<div id="ad_c1" class="c_ad_block">     <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;" data-ad-client="ca-pub-4210569241504288" data-ad-slot="5457903683" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><iframe width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/saved_resource.html"></iframe></ins></ins></ins></div>
<div id="under_post_news"><div class="itnews c_ad_block"><b>最新IT新闻</b>:<br> ·  <a href="http://news.cnblogs.com/n/555683/" target="_blank">马化腾对话钱颖一：首次揭秘！原来微信竟是这样诞生的</a><br> ·  <a href="http://news.cnblogs.com/n/555502/" target="_blank">酷炫动图（二十）：视错觉篇</a><br> ·  <a href="http://news.cnblogs.com/n/555682/" target="_blank">大规模DDoS攻击事件让HomeKit从中受益？</a><br> ·  <a href="http://news.cnblogs.com/n/555681/" target="_blank">外媒称：美国网站宕机 跟中国摄像头组件有关</a><br> ·  <a href="http://news.cnblogs.com/n/555680/" target="_blank">魅族李楠喊话友商：侵犯我们专利的请给我们个交代</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="ad_c2" class="c_ad_block"><a href="https://www.jiguang.cn/devservice/?from=cnblogs01" target="_blank"><img width="468" height="60" src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/24442-20161011141820868-1378717477.jpg" alt=""></a></div>
<div id="under_post_kb"><div class="itnews c_ad_block" id="kb_block"><b>最新知识库文章</b>:<br><div id="kb_recent"> ·  <a href="http://kb.cnblogs.com/page/553682/" target="_blank">陈皓：什么是工程师文化？</a><br> ·  <a href="http://kb.cnblogs.com/page/551422/" target="_blank">没那么难，谈CSS的设计模式</a><br> ·  <a href="http://kb.cnblogs.com/page/550625/" target="_blank">程序猿媳妇儿注意事项</a><br> ·  <a href="http://kb.cnblogs.com/page/540529/" target="_blank">可是姑娘，你为什么要编程呢？</a><br> ·  <a href="http://kb.cnblogs.com/page/549631/" target="_blank">知其所以然（以算法学习为例）</a><br></div>» <a href="http://kb.cnblogs.com/" target="_blank">更多知识库文章...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>


	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"><img style="width: 200px; height: 200px; margin: 0 auto; padding: 2px;" src="./Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法） - Jamy Cai - 博客园_files/o_xiaolaotou_round_blue.png" alt="">
<p><strong>个人简介：</strong></p><hr style="width: 100%" color="#169FE6"><p>软件研发工程师，北京，<span style="line-height: 1.5">自我挖掘 ● 超越自我</span><span style="line-height: 1.5">！</span><br>2015.6-至今：搜狗公司&nbsp;<br> 2013.6-2015.6: 奇虎360</p><p>2013.2-2013.6:傲游公司</p>
<strong style="line-height: 1.5">昵称：</strong><span style="line-height: 1.5">Jamy Cai</span><p><strong style="line-height: 1.5">QQ：</strong>515581258</p><p><strong>
邮箱：</strong><span style="line-height: 1.5">Jczmdeveloer@126.com</span></p><p><strong>GitHub：</strong></p><p><a href="https://github.com/jczmdeveloper">https://github.com/jczmdeveloper</a></p>
<p><strong>GitHub博客：</strong><a href="http://jczmdeveloper.github.io/">http://jczmdeveloper.github.io</a></p>
<p><strong>真题园网：</strong></p><p><a href="http://www.zhentiyuan.com/">http://www.zhentiyuan.com</a></p><p><strong>微博：</strong></p><p><a href="http://www.weibo.com/jczmdeveloper">http://www.weibo.com/jczmdeveloper</a></p>
<hr style="width: 100%" color="#169FE6"><div id="profile_block">昵称：<a href="http://home.cnblogs.com/u/JczmDeveloper/">Jamy Cai</a><br>园龄：<a href="http://home.cnblogs.com/u/JczmDeveloper/" title="入园时间：2011-08-10">5年2个月</a><br>粉丝：<a href="http://home.cnblogs.com/u/JczmDeveloper/followers/">100</a><br>关注：<a href="http://home.cnblogs.com/u/JczmDeveloper/followees/">1</a><div id="p_b_follow"><a href="javascript:void(0);" onclick="follow(&#39;b7f4a634-49c3-e011-8673-842b2b196315&#39;)">+加关注</a></div></div></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block">
<div id="sidebar_search" class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div id="sidebar_search_box">
<div id="widget_my_zzk" class="div_my_zzk"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></div>
<div id="widget_my_google" class="div_my_zzk"><input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event)" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk"></div>
</div>
</div>

</div><div id="sidebar_categories">
<div id="sidebar_postcategory" class="catListPostCategory sidebar-block">
<h3 class="catListTitle">随笔分类<span style="font-size:11px;font-weight:normal">(139)</span></h3>

<ul>

<li><a id="CatList_LinkList_0_Link_0" href="http://www.cnblogs.com/JczmDeveloper/category/568339.html">Android(72)</a> </li>

<li><a id="CatList_LinkList_0_Link_1" href="http://www.cnblogs.com/JczmDeveloper/category/541822.html">COM/STL/WTL/ATL(26)</a> </li>

<li><a id="CatList_LinkList_0_Link_2" href="http://www.cnblogs.com/JczmDeveloper/category/460719.html">笔试/面试(17)</a> </li>

<li><a id="CatList_LinkList_0_Link_3" href="http://www.cnblogs.com/JczmDeveloper/category/492635.html">设计模式(5)</a> </li>

<li><a id="CatList_LinkList_0_Link_4" href="http://www.cnblogs.com/JczmDeveloper/category/463120.html">数据结构与算法(11)</a> </li>

<li><a id="CatList_LinkList_0_Link_5" href="http://www.cnblogs.com/JczmDeveloper/category/460715.html">数据库技术</a> </li>

<li><a id="CatList_LinkList_0_Link_6" href="http://www.cnblogs.com/JczmDeveloper/category/542246.html">心随之笔(8)</a> </li>

</ul>

</div>

<div id="sidebar_links460702" class="catList sidebar-block">
<h3 class="catListTitle">友情链接</h3>

<ul>

<li><a id="CatList_LinkList_1_Link_0" href="http://jasca.taobao.com/" rel="nofollow">淘宝话费自助充值平台</a> </li>

<li><a id="CatList_LinkList_1_Link_1" href="http://microsoft.baike.com/" rel="nofollow">微软家园</a> </li>

<li><a id="CatList_LinkList_1_Link_2" href="http://www.zhentiyuan.com/windows/index.aspx" rel="nofollow">小蔡电脑助手 V3.0</a> </li>

<li><a id="CatList_LinkList_1_Link_3" href="http://www.zhentiyuan.com/" rel="nofollow">真题园网-www.zhentiyuan.com</a> </li>
<li class="c_b_p_link_desc">真题园-最全的考试真题网! 真题园考试助手，助您园您的梦！</li>
</ul>

</div>

</div><div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap">
<div class="catListComment">
<h3 class="catListTitle">最新评论</h3>

	<div id="RecentCommentsBlock"><ul>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/JczmDeveloper/p/4185082.html#3357944">1. Re:Android 自定义View修炼-仿360手机卫士波浪球进度的实现</a></li>
        <li class="recent_comment_body">还有一个问题，就是为什么连续快速点击会出现重合的感觉呢，感觉若影若现，如果停顿点击就没有相应的bug</li>
        <li class="recent_comment_author">--不加班不加班</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/JczmDeveloper/p/4185082.html#3357939">2. Re:Android 自定义View修炼-仿360手机卫士波浪球进度的实现</a></li>
        <li class="recent_comment_body">为什么，加了android:hardwareAccelerated="false"，还是显示矩形呢，大bug啊！</li>
        <li class="recent_comment_author">--不加班不加班</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/JczmDeveloper/p/4872460.html#3333070">3. Re:Android 自定义View修炼-自定义弹幕效果View</a></li>
        <li class="recent_comment_body">楼主你好，你的这个方案很赞，但有一点瑕疵，记不太清楚原因了，应该是复写的onLayout（）会把弹幕移除屏幕，当有1个弹幕是比较容易暴露；其实每条弹幕初始化时只要setX设置坐标为屏幕之外，然后做动画......</li>
        <li class="recent_comment_author">--springcoming</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/JczmDeveloper/p/5037068.html#3324800">4. Re:Android 自定义View修炼-自定义加载进度动画XCLoadingImageView</a></li>
        <li class="recent_comment_body">支持楼主，正在学android中，很受益</li>
        <li class="recent_comment_author">--nock1990</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/JczmDeveloper/p/4872460.html#3319922">5. Re:Android 自定义View修炼-自定义弹幕效果View</a></li>
        <li class="recent_comment_body">@springcoming我试了 这种情况，没有问题啊，可以哦...</li>
        <li class="recent_comment_author">--Jamy Cai</li>
</ul>
</div>
</div>
</div></div><div id="sidebar_topviewedposts" class="sidebar-block"><div id="topview_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock"><ul><li><a href="http://www.cnblogs.com/JczmDeveloper/p/3782586.html">1. Android 自定义View修炼-自定义可动画展开收缩View的实现(5923)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/3801585.html">2. Android开发之ViewPager实现轮播图（轮播广告）效果的自定义View(4645)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/3873049.html">3. Android开发之自定义圆角矩形图片ImageView的实现(4331)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/3873043.html">4. Android开发之自定义圆形的ImageView的实现(4108)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/3772967.html">5. Android开发之手势滑动（滑动手势监听）详解(4106)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topcommentedposts" class="sidebar-block"><div id="topfeedback_posts_wrap">
<div class="catListFeedback">
<h3 class="catListTitle">评论排行榜</h3>
	<div id="TopFeedbackPostsBlock"><ul><li><a href="http://www.cnblogs.com/JczmDeveloper/archive/2013/03/22/2974742.html">1. VC++开发垃圾文件清理软件之二：垃圾文件的扫描、显示和清理(11)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/4422364.html">2. Android 自定义View修炼-Android中常见的热门标签的流式布局的实现(9)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/4192117.html">3. Android 自定义View修炼-实现自定义圆形、圆角和椭圆ImageView（使用Xfermode图形渲染方法）(8)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/4185082.html">4. Android 自定义View修炼-仿360手机卫士波浪球进度的实现(6)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/4178227.html">5. Android 自定义View修炼-仿QQ5.0 的侧滑菜单效果的实现(6)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topdiggedposts" class="sidebar-block"><div id="topdigg_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">推荐排行榜</h3>
<div id="TopDiggPostsBlock"><ul><li><a href="http://www.cnblogs.com/JczmDeveloper/p/4185082.html">1. Android 自定义View修炼-仿360手机卫士波浪球进度的实现(8)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/archive/2013/03/22/2974742.html">2. VC++开发垃圾文件清理软件之二：垃圾文件的扫描、显示和清理(4)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/4872460.html">3. Android 自定义View修炼-自定义弹幕效果View(4)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/3759183.html">4. Android 自定义View修炼-Android开发之自定义View开发及实例详解(4)</a></li><li><a href="http://www.cnblogs.com/JczmDeveloper/p/4836278.html">5. Android 自定义View修炼-高仿猎豹清理大师自定义内存开口圆环比例进度View(3)</a></li></ul></div>
</div></div></div></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright ©2016 Jamy Cai
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->


</body></html>