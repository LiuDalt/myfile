<!DOCTYPE html>
<!-- saved from url=(0086)http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link type="text/css" rel="stylesheet" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/comments.min.css">
	
	<meta http-equiv="Content-Language" content="zh-cn">
	<meta content="always" name="referrer">
						<meta name="keywords" content="组合控件,Android 实战技巧,Android教程">
			
						<meta name="description" content="组合控件是自定义控件的一种，只不过它是由其他几个原生控件组合而成，故名组合控件。在实际项目中，GUI会遇到一些可以提取出...">
			
			<title>组合控件 - Android 实战技巧 - 极客学院Wiki</title>
	
	<link rel="stylesheet" type="text/css" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/register.css">
	<link rel="shortcut icon" href="http://wiki.jikexueyuan.com/assets/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" type="text/css" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/detail.min.css">
	<link rel="stylesheet" type="text/css" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/markdownbody.min.css">
<script async="" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/analytics.js"></script><script src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/hm.js"></script><script type="text/javascript" async="" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/vds.js"></script><script src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/share.js"></script><link rel="stylesheet" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/share_style0_16.css"><link rel="stylesheet" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/share_popup.css"><link rel="stylesheet" href="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/select_share.css"></head>

<body><div id="BAIDU_DUP_fp_wrapper" style="position: absolute; left: -1px; bottom: -1px; z-index: 0; width: 0px; height: 0px; overflow: hidden; visibility: hidden; display: none;"><iframe id="BAIDU_DUP_fp_iframe" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/o.html" style="width: 0px; height: 0px; visibility: hidden; display: none;"></iframe></div>
<header class="detail-headfix">
	<nav class="w-1200 clearfix">
		<a href="http://www.jikexueyuan.com/" class="head-logo" target="_blank">
			<h2>
				<img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/logo.png" class="jklogo" alt="极客学院" data-bd-imgshare-binded="1">
			</h2>
		</a>
		<ul class="head-catalog">
			<li class="head-catalog-list">
				<a href="http://wiki.jikexueyuan.com/">Wiki</a>
			</li>
			<li class="head-catalog-list">
				<a href="http://wiki.jikexueyuan.com/list/mobile">移动开发</a>
			</li>
			<li class="head-catalog-list">
				<a href="http://wiki.jikexueyuan.com/list/android">Android</a>
			</li>
			<li class="head-catalog-list">
				<a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills">Android 实战技巧</a>
			</li>
		</ul>
		<div class="head-loginbox" id="header-loginbox"><div class="un-loginbox"><a href="http://passport.jikexueyuan.com/sso/login" class="un-loginbox-out diaLoginBtn" target="_blank">登录</a><em>|</em><a href="http://passport.jikexueyuan.com/sso/reg_phone" class="un-loginbox-out diaRegBtn" target="_blank">注册</a></div></div>
	</nav>
</header>

<div class="detail-wrapper w-1200  clearfix">
	<div class="detail-left">
		<ul class="detail-nav">
			<li class="detail-navlist navlist-one ">
				<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/">关于</a></div>
			</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/text-and-layout.html">文本与布局</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one  navlist-active ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html">组合控件</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/persistence-of-persistablemode-and-activity.html">性能测试类</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/speech-recognition.html">语音识别</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/reading-excel.html">读取 Excel</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/preferenceactivity-using-detailed-annotation.html">PreferenceActivity 使用详解</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/button-control-viewpager-page-turning.html">按钮控制 ViewPager 的左右翻页</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/switch-jdk-version-under-ubuntu.html">Ubuntu 下切换 JDK 版本</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/latest-android-devleoping-environment-eclipse-and-adt-and-android-fivepointzero.html">最新 Android 开发环境（Eclipse+ADT+Android 5.0）</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/acquring-screen-physical-size-density-and-resolution.html">获得屏幕物理尺寸、密度及分辨率</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/android-studio-and-gradle.html">Android Studio 和 Gradle</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/android-studio-importing-third-patry-repository-jar-package-so-package.html">Android Studio 导入第三方类库、jar 包和 so 库</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/apk-signature.html">APK 签名</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/confusion-and-anticompilation.html">混淆与反编译</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/multi-resolution-adapting-common-directory.html">多分辨率适配常用目录</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/getprop-and-dumpsys-commands.html">getprop 与 dumpsys命令</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/hardware-acceleration-of-simulator-under-linux.html">Linux 下的模拟器硬件加速</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/adb-remove-the-apk-installed-on-the-phone.html">adb 取出安装在手机中的 apk</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/android-studio-exporting-jar-package-module-and-acquring-cellphone-information.html">android studio 导出 jar 包（Module）并获得手机信息</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/two-open-source-chart-or-report-controls.html">两个开源的图表/报表控件</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/android-prototype-design-tool-exploration.html">Android 原型设计工具探索</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/android-fivepointone-sdk-download-and-configure.html">Android 5.1 SDK 下载与配置</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/ndk-development-in-android-studio.html">Android Studio 的 NDK 开发</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/horizontal-and-perpendicular-screen-switch.html">横竖屏切换</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/how-to-restart-the-emulator-try-genymotion.html">模拟器如何重启？试试 Genymotion！</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/persistence-of-persistablemode-and-activity.html">persistableMode 与 Activity 的持久化</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/maven-compiler-open-source-code-scanning-project-zxing.html">Maven 编译开源二维码扫描项目 zxing</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/start-another-activity-in-the-app-or-apk.html">启动另一个 App/apk 中的 Activity</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/canvas.html">画布 Canvas</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/static-human-face-detection.html">人脸检测-静态</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/photos-and-videos-with-camera.html">拍照和录像 with Camera</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/android-studio-source-code-management.html">Android Studio 中的源代码管理</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/android-hardware-camera2-operating-guide.html">android.hardware.camera2 使用指南</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/using-tablelayout-to-disguise-table-and-display-data.html">用 TableLayout 伪装表格显示数据</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/knowing-native-activity.html">了解 native activity</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/makefile-quick-start.html">Makefile 快速入门</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/picture-basesixtyfour-coding-and-decoding.html">图片的 Base64 编解码</a>
							</div>
					</li>
			<li class="detail-navlist navlist-one ">
			<div class="detail-navlist-title"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/handler-using-possible-triggering-memory-leak.html">Handler 使用中可能引发的内存泄漏</a>
							</div>
					</li>
			</ul>
		<div class="detail-left-bottom">
			Via 由 [ <a href="http://wiki.jikexueyuan.com/" class="detail-navlist-wikilogo" target="_blank">极客学院 Wiki</a> ] 提供
		</div>
	</div>
	<aside class="detail-right">
		<!-- author -->
		<div class="right-author">
			<!-- 欢迎成为极客学院WIKI作者 -->
									<!-- 授权极客学院转载 -->
				<div class="right-author-reprint">
					<a href="http://blog.csdn.net/column/details/android-tip.html" class="reprint-name right-top-img" data-name="点击授权商" target="_blank">lincyang</a>
				</div>
						</div>
		<!-- /author -->
				<!-- ad -->
		<h2 class="right-adtitle">Sponsered by</h2>
		<div class="mg-t10 ad" id="ad-right-1"><iframe id="iframe1176465_0" onload="BAIDU_SSP_renderFrame(&#39;1176465_0&#39;, this);" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/saved_resource.html" width="170" height="60" align="center,center" vspace="0" hspace="0" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" style="border:0; vertical-align:bottom;margin:0;" allowtransparency="true"></iframe></div>
		<div class="mg-t10 ad" id="ad-right-2"><iframe id="iframe1176522_0" onload="BAIDU_SSP_renderFrame(&#39;1176522_0&#39;, this);" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/saved_resource(1).html" width="170" height="40" align="center,center" vspace="0" hspace="0" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" style="border:0; vertical-align:bottom;margin:0;" allowtransparency="true"></iframe></div>
		<div class="mg-t10 ad" id="ad-right-3"><iframe id="iframe1176466_0" onload="BAIDU_SSP_renderFrame(&#39;1176466_0&#39;, this);" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/saved_resource(2).html" width="170" height="100" align="center,center" vspace="0" hspace="0" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" style="border:0; vertical-align:bottom;margin:0;" allowtransparency="true"></iframe></div>

		<!-- 请置于所有广告位代码之前 -->
		<script type="text/javascript" async="" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/xcum"></script><script type="text/javascript" async="" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/xcum(1)"></script><script type="text/javascript" async="" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/xcum(2)"></script><script type="text/javascript" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/m.js"></script>

		<!-- 广告位：注册页 -->
		<script type="text/javascript">
			BAIDU_CLB_fillSlotAsync('1176465', 'ad-right-1');
			BAIDU_CLB_fillSlotAsync('1176522', 'ad-right-2');
			BAIDU_CLB_fillSlotAsync('1176466', 'ad-right-3');
		</script>
		<!-- /ad -->
				<!-- download -->
		<h2 class="right-h2">离线下载</h2>
		<div class="right-download">
							<a href="http://passport.jikexueyuan.com/sso/login" target="_blank" class="download-pdf blue-btn">PDF版</a>
				<a href="http://passport.jikexueyuan.com/sso/login" target="_blank" class="download-epub blue-btn">ePub版</a>
			
		</div>
		<!-- /download -->

		<!-- resource -->
		<h2 class="right-h2">相关资源</h2>
		<ul class="right-resource">
						<li class="resource-item">
				<img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/iconblog.png" data-bd-imgshare-binded="1"><a href="http://wiki.jikexueyuan.com/project/notes" target="_blank"> Android&amp;Java 技术笔记</a>
			</li>
						<li class="resource-item">
				<img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/iconblog.png" data-bd-imgshare-binded="1"><a href="http://wiki.jikexueyuan.com/project/android-studio-guide" target="_blank"> Android Studio 操作手册</a>
			</li>
						<li class="resource-item">
				<img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/iconvideo.png" data-bd-imgshare-binded="1"><a href="http://www.jikexueyuan.com/course/178.html" target="_blank"> JavaScript语法详解</a>
			</li>
						<li class="resource-item">
				<img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/iconask.png" data-bd-imgshare-binded="1"><a href="http://wenda.jikexueyuan.com/question/25441" target="_blank"> BroadcastReceiver和EventBus区别是什么</a>
			</li>
						<li class="resource-item">
				<img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/icondown.png" data-bd-imgshare-binded="1"><a href="http://download.jikexueyuan.com/detail/id/2966" target="_blank"> AndroidViewAnimations 收集了很多的动画效果例子【Android】</a>
			</li>
						<li class="resource-item">
				<img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/icongroup.png" data-bd-imgshare-binded="1"><a href="http://qun.jikexueyuan.com/android/topic/303" target="_blank"> Android开源组建解析之Volley源码初解析</a>
			</li>
					</ul>
		<!-- /resource -->

	</aside>
	<div class="detail-main">
		<div class="markdown-body"><h1>组合控件</h1>
<p>组合控件是自定义控件的一种，只不过它是由其他几个原生控件组合而成，故名组合控件。</p>
<p>在实际项目中，GUI 会遇到一些可以提取出来做成自定义控件情况。</p>
<p>一个自定义控件的好处就是把一些需要模块化的 UI 和逻辑放在一起，做到了高内聚，向其他模块提供接口并很少依赖外界，这样就是低耦合。一个自定义控件就是一个封闭的王国，这里由你掌控。</p>
<p>上述是我自己的一个体会，想必大家也会常做自定义控件吧，就像逻辑部分的模块化一样。</p>
<p>下面我要做一个例子，请看完成图。</p>
<p><img src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/2-1.png" alt="fig.1" data-bd-imgshare-binded="1"></p>
<p>下面一排图片加文字就是组合控件了，我是怎么做的呢？</p>
<p>其实这里用到了两个组合控件，一个是图片+文字，我把它叫一个 Item，而三个在一起就是另一个控件了。</p>
<p>重点看这个 Item，它有自己的属性如图片、文字、图片大小、文字大小、不透明度等等。这些把它定义在 attr 文件中，然后在 xml 文件中配置，就像我们用原生控件一样。</p>
<p>先看 attr 文件。</p>
<pre><code>    &lt;?xml version="1.0" encoding="utf-8"?&gt;  
    &lt;resources&gt;  
            &lt;declare-styleable name="LevelMenuItem"&gt;  
            &lt;attr name="text" format="string" /&gt;  
            &lt;attr name="text_color" format="color"/&gt;  
            &lt;attr name="text_size" format="dimension" /&gt;          
            &lt;attr name="image_src" format="reference"/&gt;  
            &lt;attr name="image_bg" format="reference"/&gt;  
            &lt;attr name="image_alpha" format="integer" /&gt;  
            &lt;attr name="image_height" format="dimension"&gt;&lt;/attr&gt;  
            &lt;attr name="image_width" format="dimension" /&gt;  
        &lt;/declare-styleable&gt;  
    &lt;/resources&gt;  </code></pre>
<p>这个文件在 values 下，和 string 文件同级。把你自己要定义的属性都写在这里吧。format 是属性的“单位”，如果你要问有多少中 format 呀？答案在<a rel="nofollow" href="http://blog.csdn.net/lincyang/article/details/7421757" "="">这里</a>。</p>
<p>有了属性了，下面看看布局文件 level_menu_item.xml。</p>
<pre><code>    &lt;?xml version="1.0" encoding="utf-8"?&gt;  
    &lt;LinearLayout xmlns:android="http:// schemas.android.com/apk/res/android"  
        android:layout_width="fill_parent"  
        android:layout_height="fill_parent"  
        android:orientation="vertical" &gt;  
            &lt;ImageView  
                android:id="@+id/image_item"  
                android:layout_width="fill_parent"  
                android:layout_height="fill_parent"  
                android:scaleType="fitCenter"  
                /&gt;  
             &lt;TextView  
                android:id="@+id/tv_item"  
                android:layout_width="fill_parent"  
                android:layout_height="wrap_content"  
                android:gravity="center_horizontal"  
                android:textColor="#23ffffff"  
                android:textSize="25sp"   
             /&gt;      
    &lt;/LinearLayout&gt;  </code></pre>
<p>这里唯一值得一说的是文本的颜色。大家看见他是8位的，前两位是表示不透明度的，后六位是表示颜色的，三色，范围都是00～ff。</p>
<p>如果在 Java 中设置颜色，需要这样。</p>
<pre><code>    setTextColor(0x23ffffff);  </code></pre>
<p>关于不透明度，一般美工会定义。有些要求不透明如30%这样的，可以用整型换算一下。00～ff 对应十进制为0～255，那么30%就是255x0.3=76.5，用科学计算机换算为4c。</p>
<p>更多颜色相关请看<a rel="nofollow" href="http://blog.csdn.net/lincyang/article/details/5871117" "="">《Android 中设置文本颜色的三种办法》</a></p>
<p>然后我们就要写一个类，我这继承子线性布局。有两个构造函数，我们主要在两个参数的函数中工作。</p>
<pre><code>    public class LevelMenuItem extends LinearLayout {  

        public LevelMenuItem(Context context, AttributeSet attrs) {  
            super(context, attrs);  

        }  </code></pre>
<p>这个类中我们要完成的工作是，初始化控件属性、提供外部修改属性的接口、控件点击的回调接口。 </p>
<p>此类完整代码：</p>
<pre><code>    package com.linc.game;  

    import android.content.Context;  
    import android.content.res.TypedArray;  
    import android.util.AttributeSet;  
    import android.view.LayoutInflater;  
    import android.view.View;  
    import android.widget.ImageView;  
    import android.widget.LinearLayout;  
    import android.widget.TextView;  
    /** 
     * 自定义一个关卡 
     * 共有7个属性，看attr文件 
     * 在程序中提供修改这7个属性的接口， 
     * 一个自定义控件的任务就算完成。 
     * 一个自定义控件的好处就是把一些需要模块化的 
     * UI和逻辑放在一起，做到了高内聚，向其他模块提供接口并很少 
     * 依赖外界，这样就是低耦合。一个自定义控件就是一个封闭的王国， 
     * 这里由你掌控。 
     *  
     * 编写时，如果遇到在attr里写好属性，但是在这里认不出来， 
     * 就clean一下项目。切记。 
     *  
     * @author linc 
     * 
     */  
    public class LevelMenuItem extends LinearLayout {  
        private TextView mTextView = null;  
        private ImageView mImageView = null;  

        public LevelMenuItem(Context context) {  
            super(context);  
        }  
        public LevelMenuItem(Context context, AttributeSet attrs) {  
            super(context, attrs);  

            LayoutInflater layoutInflater = (LayoutInflater) context.  
                            getSystemService(Context.LAYOUT_INFLATER_SERVICE);  
            layoutInflater.inflate(R.layout.level_menu_item, this);  

            TypedArray typedArray = context.obtainStyledAttributes(attrs  
                    ,R.styleable.LevelMenuItem);  

            initWidget(typedArray);  
        }  
        private void initWidget(TypedArray typedArray)  
        {  
            mTextView = (TextView)findViewById(R.id.tv_item);  
            String textString = typedArray.getString(R.styleable.LevelMenuItem_text);  
            int textColor = typedArray.getColor(R.styleable.LevelMenuItem_text_color,  
                    0xffffffff);  
            float textSize = typedArray.getDimension(R.styleable.LevelMenuItem_text_size,  
                    20);  
            mTextView.setText(textString);  
            mTextView.setTextColor(textColor);  
            mTextView.setTextSize(textSize);  

            mImageView = (ImageView)findViewById(R.id.image_item);  
            int imageHeight = (int) typedArray.getDimension(R.styleable.LevelMenuItem_image_height, 25);  
            int imageWidth = (int) typedArray.getDimension(R.styleable.LevelMenuItem_image_width, 25);  
            int imageSrc = typedArray.getResourceId(R.styleable.LevelMenuItem_image_src, 0);  
            int imageBg = typedArray.getResourceId(R.styleable.LevelMenuItem_image_bg, 0);  
            int imageAlpha = typedArray.getInt(R.styleable.LevelMenuItem_image_alpha, 255);  
            mImageView.setAlpha(imageAlpha);  
            mImageView.setImageResource(imageSrc);  
            mImageView.setBackgroundResource(imageBg);  
            LayoutParams layoutParams = new LayoutParams(imageWidth, imageHeight);  
            mImageView.setLayoutParams(layoutParams);  

            typedArray.recycle();  
        }  
        /** 
         * 设置此控件的文本 
         * @param text 
         */  
        public void setText(String text)  
        {  
            mTextView.setText(text);  
        }  
        /** 
         * 设置文字颜色 
         * @param textColor 
         */  
         public void setTextColor(int textColor)  
        {  
            mTextView.setTextColor(textColor);  
        }  
        /** 
         * 设置字体大小 
         * @param textSize 
         */  
         public void setTextSize(int textSize)  
        {  
            mTextView.setTextSize(textSize);  
        }  
        /** 
         * 设置图片 
         * @param resId 
         */  
         public void setImageResource(int resId)  
        {  
            mImageView.setImageResource(resId);  
        }  
        /** 
         * 设置图片背景 
         */  
         public void setBackgroundResource(int resId)  
        {  
            mImageView.setBackgroundResource(resId);  
        }     
        /** 
         * 设置图片的不透名度 
         * @param alpha 
         */  
        public void setImageAlpha(int alpha)  
        {  
            mImageView.setAlpha(alpha);  
        }  
        /** 
         * 设置图片的大小 
         * 这里面需要使用LayoutParams这个布局参数来设置 
         * @param width 
         * @param height 
         */  
        public void setImageSize(int width,int height)  
        {  
            LayoutParams layoutParams = new LayoutParams(width, height);  
            mImageView.setLayoutParams(layoutParams);  
        }  
        /** 
         * image点击事件的回调 
         * @param listener 
         */  
        public void setOnClickListener(OnItemClickListener listener)  
        {  
            mImageView.setOnClickListener(new View.OnClickListener() {  
                @Override  
                public void onClick(View v) {  
                    listener.onImageClick();  
                }  
            });  
        }  
        /** 
         * 点击事件接口 
         * @author linc 
         * 
         */  
        public interface OnItemClickListener  
        {  
            public void onImageClick();  
        }  
    }  </code></pre>
<p>好，一个完整的组合控件就做好了，那么，我们如何使用呢？</p>
<p>我要在 LevelMenu 中用它。xml 文件如下：</p>
<pre><code>    &lt;?xml version="1.0" encoding="utf-8"?&gt;  
    &lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"  
        xmlns:linc="http://schemas.android.com/apk/res/com.linc.game"  
        android:layout_width="fill_parent"  
        android:layout_height="fill_parent"  
        android:orientation="horizontal"&gt;      
        &lt;com.linc.game.LevelMenuItem  
            android:id="@+id/item1"  
            android:layout_width="70dp"  
            android:layout_height="80dp"  
            linc:text="@string/item1"  
            linc:text_size="14sp"  
            linc:text_color="#80fa8072"  
            linc:image_src="@drawable/orange_button_selector"  
            linc:image_alpha="128"  
            linc:image_height="48dp"  
            linc:image_width="48dp"  
            /&gt;  
        &lt;com.linc.game.LevelMenuItem  
            android:id="@+id/item2"  
            android:layout_marginLeft="20dp"  
            android:layout_width="70dp"  
            android:layout_height="80dp"  
            linc:text="@string/item2"  
            linc:text_size="14sp"  
            linc:text_color="#ffeee8aa"  
            linc:image_src="@drawable/red_button_selector"  
            linc:image_alpha="255"  
            linc:image_height="48dp"  
            linc:image_width="48dp"  
            /&gt;     
        &lt;com.linc.game.LevelMenuItem  
            android:id="@+id/item3"  
            android:layout_marginLeft="20dp"  
            android:layout_width="70dp"  
            android:layout_height="80dp"  
            linc:text="@string/item3"  
            linc:text_size="14sp"  
            linc:text_color="#80cd853f"               linc:image_src="@drawable/yellow_button_selector"  
            linc:image_alpha="128"  
            linc:image_height="48dp"  
            linc:image_width="48dp"  
            /&gt;         
    &lt;/LinearLayout&gt;  </code></pre>
<p>加入自己包名的索引</p>
<pre><code>    xmlns:linc="http://schemas.android.com/apk/res/com.linc.game"  </code></pre>
<p>剩下的就一目了然了。</p>
<p>LevelMenu.java</p>
<pre><code>    package com.linc.game;  

    import com.linc.game.LevelMenuItem.OnItemClickListener;  
    import android.content.Context;  
    import android.util.AttributeSet;  
    import android.util.Log;  
    import android.view.LayoutInflater;  
    import android.widget.LinearLayout;  

    public class LevelMenu extends LinearLayout {  
        private LevelMenuItem item1,item2,item3;  

        public LevelMenu(Context context) {  
            super(context);  

        }  

        public LevelMenu(Context context, AttributeSet attrs) {  
            super(context, attrs);  
            LayoutInflater layoutInflater = (LayoutInflater) context.  
                getSystemService(Context.LAYOUT_INFLATER_SERVICE);  
            layoutInflater.inflate(R.layout.level_menu, this);  
            initWidget();  
        }  
        private void initWidget()  
        {  
            item1 = (LevelMenuItem)findViewById(R.id.item1);  
            item2 = (LevelMenuItem)findViewById(R.id.item2);  
            item3 = (LevelMenuItem)findViewById(R.id.item3);  

            item1.setOnClickListener(new OnItemClickListener() {  
                @Override  
                public void onImageClick() {  
                    Log.e("dfjdkfjd","dfdfd");  
                }  
            });  
        }  
    }  </code></pre>
<p>在处理图片点击事件的时候，我用到了选择器（selector），这是我们实际开发中最常用的小技巧了。它能描述的状态很多，各位看官可以去查查。</p>
<pre><code>    &lt;?xml version="1.0" encoding="utf-8"?&gt;  
    &lt;selector xmlns:android="http://schemas.android.com/apk/res/android" &gt;  
        &lt;item android:state_pressed="true"  
            android:drawable="@drawable/button_push"/&gt;  
        &lt;item android:drawable="@drawable/orange_button"/&gt;  
    &lt;/selector&gt;  </code></pre>
<p>好，组合控件的例子先到这里，实际功能在下一个实战技巧中演练。</p>
<p>大家在做自定义控件时需要注意的是：</p>
<p>1、自定义控件类不能是是抽象类</p>
<p>2、要用</p>
<pre><code>      (Context context, AttributeSet attrs)  </code></pre>
<p>这个构造函数</p>
<p>否则报错：android.view.InflateException: Binary XML file line #15: Error inflating cla。。。</p></div>

		
		<div class="previous-and-next">
							<span class="pull-left">上一篇: <a id="previous_link" href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/text-and-layout.html" data-toggle="tooltip" data-placement="top" title="" data-original-title="上翻页快捷键：左方向键">文本与布局</a></span>
			
							<span class="pull-right">下一篇: <a id="next_link" href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/persistence-of-persistablemode-and-activity.html" data-toggle="tooltip" data-placement="top" title="" data-original-title="下翻页快捷键：右方向键">性能测试类</a></span>
					</div>

		<div class="detail-share clearfix">
			<div class="bdsharebuttonbox share-item bdshare-button-style0-16" data-bd-bind="1471271581103">
				<a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_more" data-cmd="more"></a>
				<a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
				<a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
				<a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
				<a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a>
			</div>
			<script>
				window._bd_share_config = {
					"common": {
						"bdSnsKey": {},
						"bdText": "",
						"bdMini": "2",
						"bdMiniList": false,
						"bdPic": "",
						"bdStyle": "0",
						"bdSize": "16"
					},
					"share": {},
					"image": {
						"viewList": ["weixin", "tsina", "qzone", "youdao"],
						"viewText": "分享到：",
						"viewSize": "16"
					},
					"selectShare": {
						"bdContainerClass": null,
						"bdSelectMiniList": ["weixin", "tsina", "qzone", "youdao"]
					}
				};
				with(document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
			</script>
		</div>
					<div id="jkcomments"><ul></ul><div id="pager"></div><div class="jkxy-subask-nologin">只有登录了才能参与评论，快<a href="http://passport.jikexueyuan.com/sso/login">登录</a>！如果你还没有账号你可以<a href="http://passport.jikexueyuan.com/sso/reg_phone">注册</a>一个账号。</div></div>
					<div class="wiki-right">
			<div class="backtotop">
				<a href="javascript:;" class="btn-backtotop" style="">
					<div class="arrow"></div>
					<div class="stick"></div>
				</a>
			</div>
		</div>
	</div>

</div>
<script type="text/javascript" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/jquery.min.js"></script>
<script type="text/javascript" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/detail.js"></script>
<script type="text/javascript" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/bootstrap.min.js"></script>
<script type="text/javascript" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/LoginAndRegister.js"></script><script src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/m.js"></script>


	<script>
		var JKcomments = {
			perPage: 15,
			model: "wiki", //模块名称（必填）
			parent_id: "android-actual-combat-skills",
			item_id: "7ca383f32ec1fac6461279703572d9bd" //被评论信息ID（必填）
		}
	</script>
	<script type="text/javascript" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/comments.min.js"></script>
	
<script>
var _vds = _vds || [];
window._vds = _vds;
(function(){
  _vds.push(['setAccountId', 'aacd01fff9535e79']);
    (function() {
    var vds = document.createElement('script');
    vds.type='text/javascript';
    vds.async = true;
    vds.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'dn-growing.qbox.me/vds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(vds, s);
  })();
})();
</script>

<script type="text/javascript">
    $(function(){
        $('[data-toggle="tooltip"]').tooltip();
    });
    var _Sjkxy     = _Sjkxy || [];
    _Sjkxy['params']    = {wikiP:'Android 实战技巧' , posId:117001, po:69001 , wPId : '367'};
</script>

<!-- 极客学院分析 -->
<script type="text/javascript">
    var _Sjkxy     = _Sjkxy || [];
    _Sjkxy['jPro'] = 'wiki';
</script>
<script src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/JKanalysis.js"></script>
<script>
//baidu分析
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?1320421bf6332884ce38374c23776351";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
//google分析
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-50413628-2', 'auto');
ga('send', 'pageview');
</script>




<iframe frameborder="0" id="bdSharePopup_selectshare1471271581112bg" class="bdselect_share_bg" style="display:none;" src="./组合控件 - Android 实战技巧 - 极客学院Wiki_files/saved_resource(3).html"></iframe><div id="bdSharePopup_selectshare1471271581112box" style="display: none;" share-type="selectshare" class="bdselect_share_box" data-bd-bind="1471271581111"><div class="selectshare-mod-triangle"><div class="triangle-border"></div><div class="triangle-inset"></div></div><div class="bdselect_share_head"><span>分享到</span><a href="http://www.baidu.com/s?wd=&amp;tn=SE_hldp08010_vurs2xrp" class="bdselect_share_dialog_search" target="_blank"><i class="bdselect_share_dialog_search_i"></i><span class="bdselect_share_dialog_search_span">百度一下</span></a><a class="bdselect_share_dialog_close"></a></div><div class="bdselect_share_content"><ul class="bdselect_share_list bdshare-button-style0-16"><div class="bdselect_share_partners"><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_weixin" data-cmd="weixin"></a><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_tsina" data-cmd="tsina"></a><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_qzone" data-cmd="qzone"></a><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_youdao" data-cmd="youdao"></a></div><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" class="bds_more" data-cmd="more"></a></ul></div></div><div id="bdimgshare_1471271581116" class="sr-bdimgshare sr-bdimgshare-list sr-bdimgshare-16 sr-bdimgshare-black" style="height:36px;line-height:26px;font-size:12px;width:autopx;display:none;" data-bd-bind="1471271581115"><div class="bdimgshare-bg"></div><div class="bdimgshare-content bdsharebuttonbox bdshare-button-style0-16"><label class="bdimgshare-lbl">分享到：</label><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" onclick="return false;" class="bds_weixin" data-cmd="weixin" hidefocus=""></a><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" onclick="return false;" class="bds_tsina" data-cmd="tsina" hidefocus=""></a><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" onclick="return false;" class="bds_qzone" data-cmd="qzone" hidefocus=""></a><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" onclick="return false;" class="bds_youdao" data-cmd="youdao" hidefocus=""></a><a href="http://wiki.jikexueyuan.com/project/android-actual-combat-skills/combined-control.html#" onclick="return false;" class="bds_more" data-cmd="more" hidefocus=""></a></div></div></body></html>